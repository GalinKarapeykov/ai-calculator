<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculator with History</title>
  <style>
    * {
      transition: background-color 0.3s, color 0.3s;
    }

    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 100%);
    }

    body.light-mode {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }
    
    .top-bar {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 100;
    }

    .theme-toggle {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1em;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transition: all 0.3s;
    }

    .theme-toggle:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 7px 20px rgba(0, 0, 0, 0.4);
    }

    body.light-mode .theme-toggle {
      background: #667eea;
    }
    
    .container {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
      justify-content: center;
      padding: 20px;
    }
    
    .calculator {
      background: #2d2d44;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 
                  0 0 30px rgba(102, 126, 234, 0.2);
      width: 320px;
    }

    body.light-mode .calculator {
      background: white;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15),
                  0 0 30px rgba(102, 126, 234, 0.1);
    }
    
    .display {
      background: #1a1a2e;
      color: #00ff00;
      font-size: 2em;
      padding: 15px;
      border-radius: 8px;
      text-align: right;
      margin-bottom: 15px;
      min-height: 50px;
      word-wrap: break-word;
      box-shadow: inset 0 5px 15px rgba(0, 0, 0, 0.5);
    }

    body.light-mode .display {
      background: #f0f0f0;
      color: #333;
      box-shadow: inset 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
    }
    
    button {
      padding: 15px;
      font-size: 1.2em;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: #3a3a52;
      color: white;
      transition: all 0.2s;
      font-weight: bold;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    body.light-mode button {
      background: #f0f0f0;
      color: #333;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    button:hover {
      background: #4a4a62;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }

    body.light-mode button:hover {
      background: #e0e0e0;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }
    
    button.operator {
      background: #667eea;
      color: white;
    }
    
    button.operator:hover {
      background: #5568d3;
      transform: translateY(-2px);
    }

    body.light-mode button.operator {
      background: #667eea;
      color: white;
    }
    
    button.equals {
      background: #48bb78;
      color: white;
      grid-column: span 2;
    }
    
    button.equals:hover {
      background: #38a169;
      transform: translateY(-2px);
    }
    
    button.clear {
      background: #f56565;
      color: white;
    }
    
    button.clear:hover {
      background: #e53e3e;
      transform: translateY(-2px);
    }

    button.backspace {
      background: #ed8936;
      color: white;
    }

    button.backspace:hover {
      background: #dd6b20;
      transform: translateY(-2px);
    }
    
    .history {
      background: #2d2d44;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6),
                  0 0 30px rgba(102, 126, 234, 0.2);
      width: 320px;
      max-height: 400px;
      overflow-y: auto;
    }

    body.light-mode .history {
      background: white;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15),
                  0 0 30px rgba(102, 126, 234, 0.1);
    }
    
    .history h3 {
      margin-top: 0;
      color: #667eea;
    }

    body.light-mode .history h3 {
      color: #667eea;
    }
    
    .history-item {
      padding: 12px;
      background: #3a3a52;
      margin-bottom: 10px;
      border-radius: 8px;
      border-left: 4px solid #667eea;
      font-family: monospace;
      cursor: pointer;
      transition: all 0.2s;
      color: #fff;
    }

    body.light-mode .history-item {
      background: #f9f9f9;
      color: #333;
    }
    
    .history-item:hover {
      background: #4a4a62;
      transform: translateX(5px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
    }

    body.light-mode .history-item:hover {
      background: #efefef;
    }
    
    .history-empty {
      color: #999;
      text-align: center;
    }

    .history-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }

    .clear-history-btn {
      flex: 1;
      background: #f56565;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9em;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transition: all 0.2s;
    }

    body.light-mode .clear-history-btn {
      background: #f56565;
      color: white;
    }

    .clear-history-btn:hover {
      background: #e53e3e;
      transform: translateY(-2px);
      box-shadow: 0 7px 20px rgba(0, 0, 0, 0.4);
    }

    /* Scrollbar styling */
    .history::-webkit-scrollbar {
      width: 8px;
    }

    .history::-webkit-scrollbar-track {
      background: #3a3a52;
      border-radius: 10px;
    }

    body.light-mode .history::-webkit-scrollbar-track {
      background: #f0f0f0;
    }

    .history::-webkit-scrollbar-thumb {
      background: #667eea;
      border-radius: 10px;
    }

    .history::-webkit-scrollbar-thumb:hover {
      background: #5568d3;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <button class="theme-toggle" onclick="toggleTheme()">üåô Dark Mode</button>
  </div>

  <div class="container">
    <div class="calculator">
      <div class="display" id="display">0</div>
      <div class="buttons">
        <button class="operator" onclick="appendOperator('+')">+</button>
        <button onclick="appendNumber('7')">7</button>
        <button onclick="appendNumber('8')">8</button>
        <button onclick="appendNumber('9')">9</button>
        
        <button class="operator" onclick="appendOperator('-')">-</button>
        <button onclick="appendNumber('4')">4</button>
        <button onclick="appendNumber('5')">5</button>
        <button onclick="appendNumber('6')">6</button>
        
        <button class="operator" onclick="appendOperator('*')">*</button>
        <button onclick="appendNumber('1')">1</button>
        <button onclick="appendNumber('2')">2</button>
        <button onclick="appendNumber('3')">3</button>
        
        <button class="operator" onclick="appendOperator('/')">/</button>
        <button onclick="appendNumber('0')">0</button>
        <button onclick="appendNumber('.')">.</button>
        <button class="backspace" onclick="backspace()">‚Üê</button>
        
        <button class="operator" onclick="appendOperator('%')">%</button>
        <button class="clear" onclick="clearDisplay()">C</button>
        <button class="equals" onclick="calculate()">=</button>
      </div>
    </div>
    
    <div class="history">
      <h3>üìã History</h3>
      <div class="history-controls">
        <button class="clear-history-btn" onclick="clearHistory()">Clear History</button>
      </div>
      <div id="historyList" class="history-empty">No calculations yet</div>
    </div>
  </div>

  <script>
    let display = document.getElementById('display');
    let historyList = document.getElementById('historyList');
    let currentInput = '0';
    let operator = null;
    let previousValue = null;
    let history = [];
    let isDarkMode = true;

    function updateDisplay() {
      display.textContent = currentInput;
    }

    function appendNumber(num) {
      if (currentInput === '0' && num !== '.') {
        currentInput = num;
      } else if (num === '.' && currentInput.includes('.')) {
        return;
      } else {
        currentInput += num;
      }
      updateDisplay();
    }

    function appendOperator(op) {
      if (operator !== null && currentInput !== '') {
        calculate();
      }
      previousValue = currentInput;
      operator = op;
      currentInput = '0';
    }

    function calculate() {
      if (operator === null || previousValue === null) return;

      let result;
      const prev = parseFloat(previousValue);
      const current = parseFloat(currentInput);

      switch(operator) {
        case '+':
          result = prev + current;
          break;
        case '-':
          result = prev - current;
          break;
        case '*':
          result = prev * current;
          break;
        case '/':
          result = current !== 0 ? prev / current : 'Error';
          break;
        case '%':
          result = prev % current;
          break;
        default:
          return;
      }

      const calculation = `${prev} ${operator} ${current} = ${result}`;
      addToHistory(calculation);

      currentInput = result.toString();
      operator = null;
      previousValue = null;
      updateDisplay();
    }

    function clearDisplay() {
      currentInput = '0';
      operator = null;
      previousValue = null;
      updateDisplay();
    }

    function backspace() {
      if (currentInput.length > 1) {
        currentInput = currentInput.slice(0, -1);
      } else {
        currentInput = '0';
      }
      updateDisplay();
    }

    function addToHistory(calculation) {
      history.unshift(calculation);
      if (history.length > 10) {
        history.pop();
      }
      renderHistory();
    }

    function renderHistory() {
      if (history.length === 0) {
        historyList.innerHTML = '<div class="history-empty">No calculations yet</div>';
        return;
      }
      historyList.innerHTML = history.map((item, index) => 
        `<div class="history-item" onclick="useHistoryValue('${item}')">${item}</div>`
      ).join('');
    }

    function useHistoryValue(item) {
      const result = item.split('=')[1].trim();
      currentInput = result;
      updateDisplay();
    }

    function clearHistory() {
      if (confirm('Are you sure you want to clear all history?')) {
        history = [];
        renderHistory();
      }
    }

    function toggleTheme() {
      isDarkMode = !isDarkMode;
      const body = document.body;
      const themeToggle = document.querySelector('.theme-toggle');
      
      if (isDarkMode) {
        body.classList.remove('light-mode');
        themeToggle.textContent = 'üåô Dark Mode';
      } else {
        body.classList.add('light-mode');
        themeToggle.textContent = '‚òÄÔ∏è Light Mode';
      }
    }

    // KEYBOARD SUPPORT
    document.addEventListener('keydown', (e) => {
      // Number keys (0-9)
      if (e.key >= '0' && e.key <= '9') {
        appendNumber(e.key);
      }
      
      // Decimal point
      if (e.key === '.') {
        appendNumber('.');
      }
      
      // Plus (+)
      if (e.key === '+') {
        appendOperator('+');
      }
      
      // Minus (-)
      if (e.key === '-') {
        appendOperator('-');
      }
      
      // Multiply (*)
      if (e.key === '*') {
        e.preventDefault();
        appendOperator('*');
      }
      
      // Divide (/)
      if (e.key === '/') {
        e.preventDefault();
        appendOperator('/');
      }
      
      // Percent (%)
      if (e.key === '%') {
        e.preventDefault();
        appendOperator('%');
      }
      
      // Calculate (Enter or =)
      if (e.key === 'Enter' || e.key === '=') {
        e.preventDefault();
        calculate();
      }
      
      // Backspace
      if (e.key === 'Backspace') {
        e.preventDefault();
        backspace();
      }
      
      // Clear (Escape)
      if (e.key === 'Escape') {
        clearDisplay();
      }
    });
  </script>
</body>
</html>